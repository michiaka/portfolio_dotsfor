## 課題
Spreadsheet Processor

## 概要
このプロジェクトは、スプレッドシートプロセッサのバックエンドをシミュレートするクラスを開発することを目指しています。スプレッドシートは、セルの操作（値の設定、値の計算、コピー）を行うインターフェースを提供し、セルの値を定義する式をサポートし、セル間の循環依存を検出し、スプレッドシートをファイルに保存/ロードします。

## 目標
- スプレッドシートのセルに値を設定し、その値を計算できるようにする
- 式を用いてセルの値を動的に計算する
- セル間の循環依存を検出し、適切に処理する
- スプレッドシートをファイルに保存し、後で復元できるようにする

## 実装の詳細
このプロジェクトには、以下の主要なクラスと関数が含まれます：

### CSpreadsheet
スプレッドシートプロセッサ自体を表すクラスです。インスタンスは1つのシートを表します。以下の機能を実装します：
- `setCell(CPos pos, std::string contents)`: 指定されたセルに値や式を設定します。
- `getValue(CPos pos)`: 指定されたセルの値を計算して取得します。
- `copyRect(CPos dstCell, CPos srcCell, int w, int h)`: 指定された範囲のセルをコピーします。
- `save(std::ostream &os)`: スプレッドシートの内容を保存します。
- `load(std::istream &is)`: スプレッドシートの内容を読み込みます。

### CPos
シート内のセルを識別するクラスです。セルの識別子（例：A1、B2）を解析して内部表現に変換します。

### CExpressionBuilder
抽象クラスであり、式の構文解析を行うためのビルダーオブジェクトを提供します。

### CValue
セルの値を表すクラスで、未定義、数値、または文字列のいずれかです。

### parseExpression
式を解析し、ビルダーオブジェクトに解析結果を渡します。この関数は、提供された構文解析器を使用して実装します。

## チャレンジ
このプロジェクトでは以下の課題がありました：
- セル間の依存関係を管理し、循環依存を検出する
- 式を解析し、効率的に評価するためのASTを構築する
- `CopyRect`関数での絶対参照と相対参照の処理

## 使用技術
- C++
- Git

## 実行方法
本プログラムはテストベースの実行環境であり、main関数を通じて以下の操作を行います：

setCell(): セルの値を設定する
copyRect(): 指定された範囲のセルを他の範囲のセルに貼り付ける
save(): スプレッドシートの内容を保存する
load(): スプレッドシートの内容を読み込む
上記の操作を行った後、CSpreadsheet::getValue()を使用して各セルの値を出力し、プログラムをテストします。


1. リポジトリをクローンします：
    `git clone https://github.com/michiaka/teamlab_portfolio_2024.git`
    
2. クローンしたディレクトリ内でのプログラムのコンパイル
    `g++ -pedantic -Wall -Wextra -g3 -fsanitize=address -std=c++20 -L ./ main.cpp -l:libexpression_parser.a -o main`

3. クローンしたディレクトリ内でのプログラムの実行
    `./main`


 
 
 
